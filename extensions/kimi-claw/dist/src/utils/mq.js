export class MessageQueue{messages=[];waiters=[];isClosed=!1;push(s){if(this.isClosed)return;this.messages.push(s);const e=this.waiters;this.waiters=[],e.forEach(s=>s())}async read(s){return this.isClosed?null:s<this.messages.length?this.messages.slice(s):new Promise(e=>{this.waiters.push(()=>{this.isClosed?e(null):e(this.messages.slice(s))})})}close(){this.isClosed=!0;const s=this.waiters;this.waiters=[],s.forEach(s=>s())}}